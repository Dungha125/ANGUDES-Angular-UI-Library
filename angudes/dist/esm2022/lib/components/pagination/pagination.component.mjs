import { Component, Input, Output, EventEmitter } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/forms";
export class PaginationComponent {
    current = 1;
    total = 0;
    pageSize = 10;
    showSizeChanger = false;
    showQuickJumper = false;
    showTotal = false;
    simple = false;
    currentChange = new EventEmitter();
    pageSizeChange = new EventEmitter();
    get totalPages() {
        return Math.ceil(this.total / this.pageSize);
    }
    get pages() {
        const pages = [];
        const total = this.totalPages;
        const current = this.current;
        if (total <= 7) {
            for (let i = 1; i <= total; i++) {
                pages.push(i);
            }
        }
        else {
            if (current <= 4) {
                for (let i = 1; i <= 5; i++) {
                    pages.push(i);
                }
                pages.push(-1); // ellipsis
                pages.push(total);
            }
            else if (current >= total - 3) {
                pages.push(1);
                pages.push(-1); // ellipsis
                for (let i = total - 4; i <= total; i++) {
                    pages.push(i);
                }
            }
            else {
                pages.push(1);
                pages.push(-1); // ellipsis
                for (let i = current - 1; i <= current + 1; i++) {
                    pages.push(i);
                }
                pages.push(-1); // ellipsis
                pages.push(total);
            }
        }
        return pages;
    }
    goToPage(page) {
        if (page >= 1 && page <= this.totalPages && page !== this.current) {
            this.current = page;
            this.currentChange.emit(page);
        }
    }
    prev() {
        if (this.current > 1) {
            this.goToPage(this.current - 1);
        }
    }
    next() {
        if (this.current < this.totalPages) {
            this.goToPage(this.current + 1);
        }
    }
    onPageSizeChange(size) {
        this.pageSize = size;
        this.current = 1;
        this.pageSizeChange.emit(size);
        this.currentChange.emit(1);
    }
    get Math() {
        return Math;
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: PaginationComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.2.14", type: PaginationComponent, selector: "agu-pagination", inputs: { current: "current", total: "total", pageSize: "pageSize", showSizeChanger: "showSizeChanger", showQuickJumper: "showQuickJumper", showTotal: "showTotal", simple: "simple" }, outputs: { currentChange: "currentChange", pageSizeChange: "pageSizeChange" }, ngImport: i0, template: "<div \r\n  class=\"agu-pagination\"\r\n  [class.agu-pagination--simple]=\"simple\"\r\n>\r\n  <div class=\"agu-pagination__info\" *ngIf=\"showTotal && !simple\">\r\n    Showing {{ (current - 1) * pageSize + 1 }} to {{ Math.min(current * pageSize, total) }} of {{ total }} items\r\n  </div>\r\n  \r\n  <div class=\"agu-pagination__content\">\r\n    <button \r\n      class=\"agu-pagination__btn\"\r\n      [class.agu-pagination__btn--disabled]=\"current === 1\"\r\n      (click)=\"prev()\"\r\n    >\r\n      \u2039\r\n    </button>\r\n\r\n    <template *ngIf=\"!simple\">\r\n      <button\r\n        *ngFor=\"let page of pages\"\r\n        class=\"agu-pagination__page\"\r\n        [class.agu-pagination__page--active]=\"page === current\"\r\n        [class.agu-pagination__page--ellipsis]=\"page === -1\"\r\n        (click)=\"page !== -1 && goToPage(page)\"\r\n      >\r\n        {{ page === -1 ? '...' : page }}\r\n      </button>\r\n    </template>\r\n\r\n    <template *ngIf=\"simple\">\r\n      <input \r\n        type=\"number\" \r\n        class=\"agu-pagination__input\"\r\n        [value]=\"current\"\r\n        (change)=\"goToPage(+$any($event.target).value)\"\r\n        min=\"1\"\r\n        [max]=\"totalPages\"\r\n      />\r\n      <span class=\"agu-pagination__separator\">/</span>\r\n      <span class=\"agu-pagination__total\">{{ totalPages }}</span>\r\n    </template>\r\n\r\n    <button \r\n      class=\"agu-pagination__btn\"\r\n      [class.agu-pagination__btn--disabled]=\"current === totalPages\"\r\n      (click)=\"next()\"\r\n    >\r\n      \u203A\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"agu-pagination__size-changer\" *ngIf=\"showSizeChanger && !simple\">\r\n    <select \r\n      class=\"agu-pagination__select\"\r\n      [value]=\"pageSize\"\r\n      (change)=\"onPageSizeChange(+$any($event.target).value)\"\r\n    >\r\n      <option value=\"10\">10 / page</option>\r\n      <option value=\"20\">20 / page</option>\r\n      <option value=\"50\">50 / page</option>\r\n      <option value=\"100\">100 / page</option>\r\n    </select>\r\n  </div>\r\n</div>\r\n\r\n", styles: [".agu-pagination{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.agu-pagination__info{color:#00000073;font-size:.875rem}.agu-pagination__content{display:flex;align-items:center;gap:.25rem}.agu-pagination__btn{min-width:32px;height:32px;padding:0 8px;border:1px solid #d9d9d9;background:#fff;border-radius:.25rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:1rem}.agu-pagination__btn:hover:not(.agu-pagination__btn--disabled){border-color:#1890ff;color:#1890ff}.agu-pagination__btn--disabled{opacity:.5;cursor:not-allowed}.agu-pagination__page{min-width:32px;height:32px;padding:0 8px;border:1px solid #d9d9d9;background:#fff;border-radius:.25rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:.875rem}.agu-pagination__page:hover:not(.agu-pagination__page--ellipsis):not(.agu-pagination__page--active){border-color:#1890ff;color:#1890ff}.agu-pagination__page--active{background:#1890ff;border-color:#1890ff;color:#fff;font-weight:500}.agu-pagination__page--ellipsis{border:none;background:transparent;cursor:default}.agu-pagination__input{width:50px;height:32px;padding:0 8px;border:1px solid #d9d9d9;border-radius:.25rem;text-align:center}.agu-pagination__separator{margin:0 8px;color:#00000073}.agu-pagination__total{color:#00000073}.agu-pagination__size-changer{display:flex;align-items:center}.agu-pagination__select{height:32px;padding:0 8px;border:1px solid #d9d9d9;border-radius:.25rem;background:#fff;cursor:pointer;font-size:.875rem}.agu-pagination--simple .agu-pagination__content{gap:.5rem}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.NgSelectOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i2.ɵNgSelectMultipleOption, selector: "option", inputs: ["ngValue", "value"] }] });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: PaginationComponent, decorators: [{
            type: Component,
            args: [{ selector: 'agu-pagination', standalone: false, template: "<div \r\n  class=\"agu-pagination\"\r\n  [class.agu-pagination--simple]=\"simple\"\r\n>\r\n  <div class=\"agu-pagination__info\" *ngIf=\"showTotal && !simple\">\r\n    Showing {{ (current - 1) * pageSize + 1 }} to {{ Math.min(current * pageSize, total) }} of {{ total }} items\r\n  </div>\r\n  \r\n  <div class=\"agu-pagination__content\">\r\n    <button \r\n      class=\"agu-pagination__btn\"\r\n      [class.agu-pagination__btn--disabled]=\"current === 1\"\r\n      (click)=\"prev()\"\r\n    >\r\n      \u2039\r\n    </button>\r\n\r\n    <template *ngIf=\"!simple\">\r\n      <button\r\n        *ngFor=\"let page of pages\"\r\n        class=\"agu-pagination__page\"\r\n        [class.agu-pagination__page--active]=\"page === current\"\r\n        [class.agu-pagination__page--ellipsis]=\"page === -1\"\r\n        (click)=\"page !== -1 && goToPage(page)\"\r\n      >\r\n        {{ page === -1 ? '...' : page }}\r\n      </button>\r\n    </template>\r\n\r\n    <template *ngIf=\"simple\">\r\n      <input \r\n        type=\"number\" \r\n        class=\"agu-pagination__input\"\r\n        [value]=\"current\"\r\n        (change)=\"goToPage(+$any($event.target).value)\"\r\n        min=\"1\"\r\n        [max]=\"totalPages\"\r\n      />\r\n      <span class=\"agu-pagination__separator\">/</span>\r\n      <span class=\"agu-pagination__total\">{{ totalPages }}</span>\r\n    </template>\r\n\r\n    <button \r\n      class=\"agu-pagination__btn\"\r\n      [class.agu-pagination__btn--disabled]=\"current === totalPages\"\r\n      (click)=\"next()\"\r\n    >\r\n      \u203A\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"agu-pagination__size-changer\" *ngIf=\"showSizeChanger && !simple\">\r\n    <select \r\n      class=\"agu-pagination__select\"\r\n      [value]=\"pageSize\"\r\n      (change)=\"onPageSizeChange(+$any($event.target).value)\"\r\n    >\r\n      <option value=\"10\">10 / page</option>\r\n      <option value=\"20\">20 / page</option>\r\n      <option value=\"50\">50 / page</option>\r\n      <option value=\"100\">100 / page</option>\r\n    </select>\r\n  </div>\r\n</div>\r\n\r\n", styles: [".agu-pagination{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.agu-pagination__info{color:#00000073;font-size:.875rem}.agu-pagination__content{display:flex;align-items:center;gap:.25rem}.agu-pagination__btn{min-width:32px;height:32px;padding:0 8px;border:1px solid #d9d9d9;background:#fff;border-radius:.25rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:1rem}.agu-pagination__btn:hover:not(.agu-pagination__btn--disabled){border-color:#1890ff;color:#1890ff}.agu-pagination__btn--disabled{opacity:.5;cursor:not-allowed}.agu-pagination__page{min-width:32px;height:32px;padding:0 8px;border:1px solid #d9d9d9;background:#fff;border-radius:.25rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:.875rem}.agu-pagination__page:hover:not(.agu-pagination__page--ellipsis):not(.agu-pagination__page--active){border-color:#1890ff;color:#1890ff}.agu-pagination__page--active{background:#1890ff;border-color:#1890ff;color:#fff;font-weight:500}.agu-pagination__page--ellipsis{border:none;background:transparent;cursor:default}.agu-pagination__input{width:50px;height:32px;padding:0 8px;border:1px solid #d9d9d9;border-radius:.25rem;text-align:center}.agu-pagination__separator{margin:0 8px;color:#00000073}.agu-pagination__total{color:#00000073}.agu-pagination__size-changer{display:flex;align-items:center}.agu-pagination__select{height:32px;padding:0 8px;border:1px solid #d9d9d9;border-radius:.25rem;background:#fff;cursor:pointer;font-size:.875rem}.agu-pagination--simple .agu-pagination__content{gap:.5rem}\n"] }]
        }], propDecorators: { current: [{
                type: Input
            }], total: [{
                type: Input
            }], pageSize: [{
                type: Input
            }], showSizeChanger: [{
                type: Input
            }], showQuickJumper: [{
                type: Input
            }], showTotal: [{
                type: Input
            }], simple: [{
                type: Input
            }], currentChange: [{
                type: Output
            }], pageSizeChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnaW5hdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9hbmd1ZGVzL3NyYy9saWIvY29tcG9uZW50cy9wYWdpbmF0aW9uL3BhZ2luYXRpb24uY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYW5ndWRlcy9zcmMvbGliL2NvbXBvbmVudHMvcGFnaW5hdGlvbi9wYWdpbmF0aW9uLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7QUFTdkUsTUFBTSxPQUFPLG1CQUFtQjtJQUNyQixPQUFPLEdBQVcsQ0FBQyxDQUFDO0lBQ3BCLEtBQUssR0FBVyxDQUFDLENBQUM7SUFDbEIsUUFBUSxHQUFXLEVBQUUsQ0FBQztJQUN0QixlQUFlLEdBQVksS0FBSyxDQUFDO0lBQ2pDLGVBQWUsR0FBWSxLQUFLLENBQUM7SUFDakMsU0FBUyxHQUFZLEtBQUssQ0FBQztJQUMzQixNQUFNLEdBQVksS0FBSyxDQUFDO0lBQ3ZCLGFBQWEsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO0lBQzNDLGNBQWMsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO0lBRXRELElBQUksVUFBVTtRQUNaLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQsSUFBSSxLQUFLO1FBQ1AsTUFBTSxLQUFLLEdBQWEsRUFBRSxDQUFDO1FBQzNCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDOUIsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUU3QixJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUNm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LElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDO0lBRUQsSUFBSSxJQUFJO1FBQ04sT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO3dHQS9FVSxtQkFBbUI7NEZBQW5CLG1CQUFtQiw2VENUaEMsb2pFQWlFQTs7NEZEeERhLG1CQUFtQjtrQkFOL0IsU0FBUzsrQkFDRSxnQkFBZ0IsY0FDZCxLQUFLOzhCQUtSLE9BQU87c0JBQWYsS0FBSztnQkFDRyxLQUFLO3NCQUFiLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxlQUFlO3NCQUF2QixLQUFLO2dCQUNHLGVBQWU7c0JBQXZCLEtBQUs7Z0JBQ0csU0FBUztzQkFBakIsS0FBSztnQkFDRyxNQUFNO3NCQUFkLEtBQUs7Z0JBQ0ksYUFBYTtzQkFBdEIsTUFBTTtnQkFDRyxjQUFjO3NCQUF2QixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYWd1LXBhZ2luYXRpb24nLFxyXG4gIHN0YW5kYWxvbmU6IGZhbHNlLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9wYWdpbmF0aW9uLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybDogJy4vcGFnaW5hdGlvbi5jb21wb25lbnQuc2NzcydcclxufSlcclxuZXhwb3J0IGNsYXNzIFBhZ2luYXRpb25Db21wb25lbnQge1xyXG4gIEBJbnB1dCgpIGN1cnJlbnQ6IG51bWJlciA9IDE7XHJcbiAgQElucHV0KCkgdG90YWw6IG51bWJlciA9IDA7XHJcbiAgQElucHV0KCkgcGFnZVNpemU6IG51bWJlciA9IDEwO1xyXG4gIEBJbnB1dCgpIHNob3dTaXplQ2hhbmdlcjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHNob3dRdWlja0p1bXBlcjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHNob3dUb3RhbDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHNpbXBsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBPdXRwdXQoKSBjdXJyZW50Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XHJcbiAgQE91dHB1dCgpIHBhZ2VTaXplQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XHJcblxyXG4gIGdldCB0b3RhbFBhZ2VzKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gTWF0aC5jZWlsKHRoaXMudG90YWwgLyB0aGlzLnBhZ2VTaXplKTtcclxuICB9XHJcblxyXG4gIGdldCBwYWdlcygpOiBudW1iZXJbXSB7XHJcbiAgICBjb25zdCBwYWdlczogbnVtYmVyW10gPSBbXTtcclxuICAgIGNvbnN0IHRvdGFsID0gdGhpcy50b3RhbFBhZ2VzO1xyXG4gICAgY29uc3QgY3VycmVudCA9IHRoaXMuY3VycmVudDtcclxuXHJcbiAgICBpZiAodG90YWwgPD0gNykge1xyXG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSB0b3RhbDsgaSsrKSB7XHJcbiAgICAgICAgcGFnZXMucHVzaChpKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGN1cnJlbnQgPD0gNCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDU7IGkrKykge1xyXG4gICAgICAgICAgcGFnZXMucHVzaChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFnZXMucHVzaCgtMSk7IC8vIGVsbGlwc2lzXHJcbiAgICAgICAgcGFnZXMucHVzaCh0b3RhbCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoY3VycmVudCA+PSB0b3RhbCAtIDMpIHtcclxuICAgICAgICBwYWdlcy5wdXNoKDEpO1xyXG4gICAgICAgIHBhZ2VzLnB1c2goLTEpOyAvLyBlbGxpcHNpc1xyXG4gICAgICAgIGZvciAobGV0IGkgPSB0b3RhbCAtIDQ7IGkgPD0gdG90YWw7IGkrKykge1xyXG4gICAgICAgICAgcGFnZXMucHVzaChpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGFnZXMucHVzaCgxKTtcclxuICAgICAgICBwYWdlcy5wdXNoKC0xKTsgLy8gZWxsaXBzaXNcclxuICAgICAgICBmb3IgKGxldCBpID0gY3VycmVudCAtIDE7IGkgPD0gY3VycmVudCArIDE7IGkrKykge1xyXG4gICAgICAgICAgcGFnZXMucHVzaChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFnZXMucHVzaCgtMSk7IC8vIGVsbGlwc2lzXHJcbiAgICAgICAgcGFnZXMucHVzaCh0b3RhbCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcGFnZXM7XHJcbiAgfVxyXG5cclxuICBnb1RvUGFnZShwYWdlOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGlmIChwYWdlID49IDEgJiYgcGFnZSA8PSB0aGlzLnRvdGFsUGFnZXMgJiYgcGFnZSAhPT0gdGhpcy5jdXJyZW50KSB7XHJcbiAgICAgIHRoaXMuY3VycmVudCA9IHBhZ2U7XHJcbiAgICAgIHRoaXMuY3VycmVudENoYW5nZS5lbWl0KHBhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJldigpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmN1cnJlbnQgPiAxKSB7XHJcbiAgICAgIHRoaXMuZ29Ub1BhZ2UodGhpcy5jdXJyZW50IC0gMSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZXh0KCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuY3VycmVudCA8IHRoaXMudG90YWxQYWdlcykge1xyXG4gICAgICB0aGlzLmdvVG9QYWdlKHRoaXMuY3VycmVudCArIDEpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb25QYWdlU2l6ZUNoYW5nZShzaXplOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIHRoaXMucGFnZVNpemUgPSBzaXplO1xyXG4gICAgdGhpcy5jdXJyZW50ID0gMTtcclxuICAgIHRoaXMucGFnZVNpemVDaGFuZ2UuZW1pdChzaXplKTtcclxuICAgIHRoaXMuY3VycmVudENoYW5nZS5lbWl0KDEpO1xyXG4gIH1cclxuXHJcbiAgZ2V0IE1hdGgoKSB7XHJcbiAgICByZXR1cm4gTWF0aDtcclxuICB9XHJcbn1cclxuXHJcbiIsIjxkaXYgXHJcbiAgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvblwiXHJcbiAgW2NsYXNzLmFndS1wYWdpbmF0aW9uLS1zaW1wbGVdPVwic2ltcGxlXCJcclxuPlxyXG4gIDxkaXYgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvbl9faW5mb1wiICpuZ0lmPVwic2hvd1RvdGFsICYmICFzaW1wbGVcIj5cclxuICAgIFNob3dpbmcge3sgKGN1cnJlbnQgLSAxKSAqIHBhZ2VTaXplICsgMSB9fSB0byB7eyBNYXRoLm1pbihjdXJyZW50ICogcGFnZVNpemUsIHRvdGFsKSB9fSBvZiB7eyB0b3RhbCB9fSBpdGVtc1xyXG4gIDwvZGl2PlxyXG4gIFxyXG4gIDxkaXYgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvbl9fY29udGVudFwiPlxyXG4gICAgPGJ1dHRvbiBcclxuICAgICAgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvbl9fYnRuXCJcclxuICAgICAgW2NsYXNzLmFndS1wYWdpbmF0aW9uX19idG4tLWRpc2FibGVkXT1cImN1cnJlbnQgPT09IDFcIlxyXG4gICAgICAoY2xpY2spPVwicHJldigpXCJcclxuICAgID5cclxuICAgICAg4oC5XHJcbiAgICA8L2J1dHRvbj5cclxuXHJcbiAgICA8dGVtcGxhdGUgKm5nSWY9XCIhc2ltcGxlXCI+XHJcbiAgICAgIDxidXR0b25cclxuICAgICAgICAqbmdGb3I9XCJsZXQgcGFnZSBvZiBwYWdlc1wiXHJcbiAgICAgICAgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvbl9fcGFnZVwiXHJcbiAgICAgICAgW2NsYXNzLmFndS1wYWdpbmF0aW9uX19wYWdlLS1hY3RpdmVdPVwicGFnZSA9PT0gY3VycmVudFwiXHJcbiAgICAgICAgW2NsYXNzLmFndS1wYWdpbmF0aW9uX19wYWdlLS1lbGxpcHNpc109XCJwYWdlID09PSAtMVwiXHJcbiAgICAgICAgKGNsaWNrKT1cInBhZ2UgIT09IC0xICYmIGdvVG9QYWdlKHBhZ2UpXCJcclxuICAgICAgPlxyXG4gICAgICAgIHt7IHBhZ2UgPT09IC0xID8gJy4uLicgOiBwYWdlIH19XHJcbiAgICAgIDwvYnV0dG9uPlxyXG4gICAgPC90ZW1wbGF0ZT5cclxuXHJcbiAgICA8dGVtcGxhdGUgKm5nSWY9XCJzaW1wbGVcIj5cclxuICAgICAgPGlucHV0IFxyXG4gICAgICAgIHR5cGU9XCJudW1iZXJcIiBcclxuICAgICAgICBjbGFzcz1cImFndS1wYWdpbmF0aW9uX19pbnB1dFwiXHJcbiAgICAgICAgW3ZhbHVlXT1cImN1cnJlbnRcIlxyXG4gICAgICAgIChjaGFuZ2UpPVwiZ29Ub1BhZ2UoKyRhbnkoJGV2ZW50LnRhcmdldCkudmFsdWUpXCJcclxuICAgICAgICBtaW49XCIxXCJcclxuICAgICAgICBbbWF4XT1cInRvdGFsUGFnZXNcIlxyXG4gICAgICAvPlxyXG4gICAgICA8c3BhbiBjbGFzcz1cImFndS1wYWdpbmF0aW9uX19zZXBhcmF0b3JcIj4vPC9zcGFuPlxyXG4gICAgICA8c3BhbiBjbGFzcz1cImFndS1wYWdpbmF0aW9uX190b3RhbFwiPnt7IHRvdGFsUGFnZXMgfX08L3NwYW4+XHJcbiAgICA8L3RlbXBsYXRlPlxyXG5cclxuICAgIDxidXR0b24gXHJcbiAgICAgIGNsYXNzPVwiYWd1LXBhZ2luYXRpb25fX2J0blwiXHJcbiAgICAgIFtjbGFzcy5hZ3UtcGFnaW5hdGlvbl9fYnRuLS1kaXNhYmxlZF09XCJjdXJyZW50ID09PSB0b3RhbFBhZ2VzXCJcclxuICAgICAgKGNsaWNrKT1cIm5leHQoKVwiXHJcbiAgICA+XHJcbiAgICAgIOKAulxyXG4gICAgPC9idXR0b24+XHJcbiAgPC9kaXY+XHJcblxyXG4gIDxkaXYgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvbl9fc2l6ZS1jaGFuZ2VyXCIgKm5nSWY9XCJzaG93U2l6ZUNoYW5nZXIgJiYgIXNpbXBsZVwiPlxyXG4gICAgPHNlbGVjdCBcclxuICAgICAgY2xhc3M9XCJhZ3UtcGFnaW5hdGlvbl9fc2VsZWN0XCJcclxuICAgICAgW3ZhbHVlXT1cInBhZ2VTaXplXCJcclxuICAgICAgKGNoYW5nZSk9XCJvblBhZ2VTaXplQ2hhbmdlKCskYW55KCRldmVudC50YXJnZXQpLnZhbHVlKVwiXHJcbiAgICA+XHJcbiAgICAgIDxvcHRpb24gdmFsdWU9XCIxMFwiPjEwIC8gcGFnZTwvb3B0aW9uPlxyXG4gICAgICA8b3B0aW9uIHZhbHVlPVwiMjBcIj4yMCAvIHBhZ2U8L29wdGlvbj5cclxuICAgICAgPG9wdGlvbiB2YWx1ZT1cIjUwXCI+NTAgLyBwYWdlPC9vcHRpb24+XHJcbiAgICAgIDxvcHRpb24gdmFsdWU9XCIxMDBcIj4xMDAgLyBwYWdlPC9vcHRpb24+XHJcbiAgICA8L3NlbGVjdD5cclxuICA8L2Rpdj5cclxuPC9kaXY+XHJcblxyXG4iXX0=